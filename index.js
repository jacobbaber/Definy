let words = [
  "transform",
  "athlete",
  "sin",
  "tank",
  "nothing",
  "ease",
  "science",
  "pan",
  "extent",
  "cycle",
  "portion",
  "lesson",
  "sheet",
  "throat",
  "senior",
  "course",
  "more",
  "guarantee",
  "funeral",
  "ancient",
  "iron",
  "terror",
  "occur",
  "show",
  "self",
  "path",
  "problem",
  "port",
  "education",
  "emphasis",
  "matter",
  "music",
  "mask",
  "role",
  "regime",
  "ban",
  "owe",
  "meal",
  "writing",
  "definitely",
  "hide",
  "help",
  "deck",
  "collection",
  "legitimate",
  "height",
  "host",
  "though",
  "father",
  "relation",
  "downtown",
  "homeless",
  "announce",
  "sky",
  "yell",
  "analysis",
  "shopping",
  "nor",
  "initiative",
  "suggest",
  "opening",
  "attack",
  "alter",
  "finish",
  "total",
  "name",
  "wheel",
  "king",
  "danger",
  "behind",
  "model",
  "complicated",
  "body",
  "accomplish",
  "courage",
  "examine",
  "recipe",
  "proud",
  "ill",
  "consistent",
  "glove",
  "original",
  "fellow",
  "sequence",
  "approximately",
  "gallery",
  "dance",
  "society",
  "potential",
  "crash",
  "marketing",
  "already",
  "reflect",
  "base",
  "drop",
  "approach",
  "signal",
  "hand",
  "adjust",
  "favorite",
  "governor",
  "cat",
  "tired",
  "survive",
  "tension",
  "mother",
  "extra",
  "stick",
  "lock",
  "battle",
  "roof",
  "frequent",
  "satellite",
  "appeal",
  "dna",
  "loss",
  "yesterday",
  "almost",
  "spot",
  "urge",
  "device",
  "fix",
  "cover",
  "maybe",
  "manner",
  "out",
  "top",
  "explain",
  "number",
  "faculty",
  "various",
  "inform",
  "huge",
  "set",
  "status",
  "butter",
  "growing",
  "absolute",
  "truck",
  "version",
  "belong",
  "action",
  "representative",
  "debate",
  "time",
  "dimension",
  "glance",
  "along",
  "script",
  "reach",
  "mood",
  "kind",
  "attention",
  "where",
  "tendency",
  "conference",
  "very",
  "though",
  "later",
  "tie",
  "tape",
  "seed",
  "particular",
  "trade",
  "saving",
  "powder",
  "vital",
  "layer",
  "seize",
  "orientation",
  "draft",
  "narrative",
  "beer",
  "estimate",
  "star",
  "anxiety",
  "bank",
  "guideline",
  "elect",
  "pool",
  "fiction",
  "immediate",
  "fantasy",
  "committee",
  "rose",
  "thank",
  "dialogue",
  "dependent",
  "design",
  "absence",
  "welfare",
  "file",
  "job",
  "originally",
  "attach",
  "kiss",
  "branch",
  "recent",
  "large",
  "rid",
  "convention",
  "exciting",
  "impose",
  "severe",
  "struggle",
  "submit",
  "class",
  "dominate",
  "build",
  "again",
  "opening",
  "warm",
  "sample",
  "depth",
  "murder",
  "smoke",
  "whether",
  "row",
  "percentage",
  "ideal",
  "supreme",
  "stop",
  "parking",
  "speed",
  "press",
  "pocket",
  "clean",
  "remember",
  "shelf",
  "graduate",
  "bowl",
  "example",
  "treaty",
  "ensure",
  "bread",
  "island",
  "next",
  "offer",
  "pant",
  "differ",
  "spin",
  "crime",
  "range",
  "theme",
  "invest",
  "soon",
  "recovery",
  "beauty",
  "stock",
  "sacred",
  "united",
  "balance",
  "outcome",
  "pool",
  "exercise",
  "succeed",
  "advocate",
  "obligation",
  "type",
  "therefore",
  "board",
  "apartment",
  "correct",
  "penalty",
  "venture",
  "crazy",
  "domestic",
  "process",
  "reform",
  "employee",
  "somebody",
  "mental",
  "goal",
  "situation",
  "wrong",
  "ignore",
  "task",
  "career",
  "sustain",
  "drawing",
  "believe",
  "scenario",
  "tone",
  "frequency",
  "habitat",
  "chamber",
  "round",
  "locate",
  "rock",
  "marry",
  "factor",
  "afternoon",
  "ability",
  "personnel",
  "agency",
  "spirit",
  "wedding",
  "orange",
  "preserve",
  "heart",
  "obvious",
  "campaign",
  "communicate",
  "telescope",
  "whisper",
  "pass",
  "list",
  "fundamental",
  "deserve",
  "message",
  "trouble",
  "cell",
  "pattern",
  "flat",
  "cabinet",
  "significance",
  "burn",
  "item",
  "sheet",
  "start",
  "guess",
  "derive",
  "poem",
  "award",
  "garden",
  "find",
  "joy",
  "crowd",
  "evolution",
  "force",
  "priority",
  "customer",
  "test",
  "cooking",
  "basic",
  "chart",
  "prospect",
  "food",
  "strong",
  "lap",
  "generally",
  "shot",
  "recruit",
  "immigrant",
  "knee",
  "technique",
  "yard",
  "trust",
  "great",
  "naked",
  "notion",
  "flee",
  "wine",
  "useful",
  "undefined",
  "error",
  "swear",
  "killing",
  "guard",
  "admire",
  "screen",
  "sport",
  "divorce",
  "forest",
  "appropriate",
  "better",
  "consider",
  "department",
  "expert",
  "complex",
  "visible",
  "following",
  "oil",
  "furniture",
  "weather",
  "bottom",
  "security",
  "step",
  "quite",
  "subsequent",
  "viewer",
  "basis",
  "coach",
  "tire",
  "celebrate",
  "agree",
  "victory",
  "trick",
  "fault",
  "summit",
  "majority",
  "ghost",
  "whatever",
  "wait",
  "purpose",
  "command",
  "meaning",
  "adopt",
  "teaching",
  "block",
  "league",
  "rating",
  "positive",
  "promote",
  "share",
  "porch",
  "give",
  "solar",
];
const request = `https://api.dictionaryapi.dev/api/v2/entries/en/`;

function selectWord() {
  let randomNum = Math.floor(Math.random() * 408);
  let selectedWord = words[randomNum];
  return selectedWord;
}

async function getDefinition(word) {
  const res = await axios.get(request + word);
  const definition = res.data[0]["meanings"][0]["definitions"][0]["definition"];
  console.log(res);
  showDefinition(definition);
}

function startGame() {
  const selectedWord = selectWord();
  getDefinition(selectedWord);
  createLetterBoxes(selectedWord);
  letterBoxInputs(selectedWord);
  revealLetter(selectedWord);
}

function showDefinition(definition) {
  const defh4 = document.querySelector("#definition");
  defh4.innerHTML = definition;
}

function createLetterBoxes(word) {
  const wordRow = document.querySelector("#wordRow");
  for (let letters of word) {
    const letterDiv = document.createElement("div");
    letterDiv.classList.add("letter-boxes");
    letterDiv.classList.add("animate__animated");
    wordRow.append(letterDiv);
  }
}

function letterBoxInputs(selectedWord) {
  const letterBoxes = document.querySelectorAll(".letter-boxes");
  let place = 0;
  const keys = document.querySelectorAll(".key");
  const enter = document.querySelector(".enter");
  const back = document.querySelector(".back");

  enter.addEventListener("click", () => {
    const guess = getGuess();
    if (selectedWord == guess) {
      gameCompleted();
      console.log("You win!");
    } else {
      place = incorrectGuess();
      console.log("Wrong");
    }
  });

  back.addEventListener("click", () => {
    if (
      place > 0 &&
      place <= letterBoxes.length &&
      !letterBoxes[place - 1].classList.contains("hintedLetter") &&
      !letterBoxes[place - 1].classList.contains("guessedCorrectly")
    ) {
      --place;
      letterBoxes[place].classList.remove("animate__pulse");
      letterBoxes[place].innerHTML = "";
    }
  });

  for (let key of keys) {
    key.addEventListener("click", (e) => {
      if (place < letterBoxes.length) {
        while (
          letterBoxes[place].classList.contains("hintedLetter") &&
          place < letterBoxes.length - 1
        ) {
          ++place;
        }
      }

      if (
        place < letterBoxes.length &&
        !letterBoxes[place].classList.contains("hintedLetter")
      ) {
        letterBoxes[place].classList.add("animate__pulse");
        letterBoxes[place].innerHTML = e.target.innerHTML;
        if (place < letterBoxes.length) {
          ++place;
        }
      }
    });
  }

  document.addEventListener("keyup", (e) => {
    if (place < letterBoxes.length) {
      while (
        letterBoxes[place].classList.contains("hintedLetter") &&
        place < letterBoxes.length - 1
      ) {
        ++place;
      }
    }
    if (
      e.keyCode >= "65" &&
      e.keyCode <= "90" &&
      place < letterBoxes.length &&
      !letterBoxes[place].classList.contains("hintedLetter")
    ) {
      letterBoxes[place].classList.add("animate__pulse");
      letterBoxes[place].innerHTML = e.key.toUpperCase();
      if (place < letterBoxes.length) {
        ++place;
      }
    } else if (
      e.key === "Backspace" &&
      place > 0 &&
      place <= letterBoxes.length &&
      !letterBoxes[place - 1].classList.contains("hintedLetter") &&
      !letterBoxes[place - 1].classList.contains("guessedCorrectly")
    ) {
      --place;
      letterBoxes[place].classList.remove("animate__pulse");
      letterBoxes[place].innerHTML = "";
    } else if (e.key === "Enter") {
      const guess = getGuess();
      if (selectedWord == guess) {
        gameCompleted();
        console.log("You win!");
      } else {
        place = incorrectGuess();
        console.log("Wrong");
      }
    }
  });
}

function revealLetter(selectedWord) {
  let place = 0;
  const letterBoxes = document.querySelectorAll(".letter-boxes");
  const revealButton = document.querySelector(".reveal");
  revealButton.addEventListener("click", () => {
    if (
      place < selectedWord.length &&
      !letterBoxes[place].classList.contains("guessedCorrectly")
    ) {
      letterBoxes[place].innerHTML = selectedWord[place].toUpperCase();
      letterBoxes[place].classList.add("animate__flipInX");
      letterBoxes[place].classList.toggle("hintedLetter");
      ++place;
    }
  });
}

function getGuess() {
  const letterBoxes = document.querySelectorAll(".letter-boxes");
  let guess = "";
  for (let letter of letterBoxes) {
    guess = guess + letter.innerHTML;
  }
  return guess.toLowerCase();
}

function incorrectGuess() {
  const letterBoxes = document.querySelectorAll(".letter-boxes");
  let newPlace = 0;
  for (let letter of letterBoxes) {
    letter.classList.remove(
      "guessedIncorrectly",
      "animate__shakeX",
      "animate__flipInX",
      "animate__pulse"
    );
    letter.classList.add("guessedIncorrectly", "animate__shakeX");
  }
  setTimeout(() => {
    for (let letter of letterBoxes) {
      if (letter.classList.contains("hintedLetter")) {
        ++newPlace;
      } else {
        letter.innerHTML = "";
      }

      letter.classList.remove(
        "guessedIncorrectly",
        "animate__shakeX",
        "animate__flipInX",
        "animate__pulse"
      );
    }
  }, 500);
  return newPlace;
}

function gameCompleted() {
  const letterBoxes = document.querySelectorAll(".letter-boxes");
  for (let letter of letterBoxes) {
    letter.classList.remove(
      "guessedIncorrectly",
      "animate__shakeX",
      "animate__flipInX",
      "animate__pulse"
    );
    letter.classList.add("guessedCorrectly", "animate__tada");
    const nextWord = document.querySelector(".nextWord");
    nextWord.removeAttribute("disabled");
    document.addEventListener("keyup", (e) => {
      if (e.key === "Enter") {
        location.reload();
      }
    });
  }
}

const newGameButton = document.querySelector("#new-game");
newGameButton.addEventListener("click", () => {
  location.reload();
});

startGame();
